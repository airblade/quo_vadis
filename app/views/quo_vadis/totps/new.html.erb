<h1>2FA: TOTP setup</h1>

<p>1. With your authenticator app, either scan this QR code or enter the text: <pre><%= @totp.key %></pre></p>

<%== @totp.qr_code.as_svg module_size: 5 %>


<p>2. Enter the 6 digit code generated by your authenticator, to check it worked:</p>

<%= form_with model: @totp do |f| %>
  <%= f.hidden_field :key %>
  <%= f.hidden_field :hmac_key %>

  <%= f.text_field :otp, inputmode: 'decimal', autocomplete: 'one-time-code', autofocus: true, maxlength: '6' %>

  <%= f.submit 'Confirm' %>
<% end %>
